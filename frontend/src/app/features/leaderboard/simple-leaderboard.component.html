<div class="leaderboard-container">
  <!-- Skip to main content link -->
  <a href="#main-content" class="skip-link sr-only-focusable">Aller au contenu principal</a>
  
  <header role="banner">
    <h1 id="main-heading">Classement des Joueurs - Saison 2025</h1>
  </header>
  
  <!-- Loading -->
  <div *ngIf="loading" class="loading" role="status" aria-live="polite" aria-labelledby="loading-text">
    <span id="loading-text">Chargement des donn√©es du classement en cours</span>
  </div>
  
  <!-- Error -->
  <div *ngIf="error" class="error" role="alert" aria-live="assertive" aria-labelledby="error-heading">
    <h2 id="error-heading">Erreur de chargement</h2>
    <p id="error-message">{{ error }}</p>
    <button (click)="loadData()" aria-label="R√©essayer le chargement des donn√©es" aria-describedby="error-message">R√©essayer</button>
  </div>
  
  <!-- Empty Leaderboard State -->
  <div *ngIf="!loading && !error && filteredPlayers.length === 0" class="no-game-selected" role="status" aria-live="polite">
    <div class="empty-state-icon">Œî</div>
    <h2>Aucune donn√©e de classement</h2>
    <p>Aucune √©quipe ou joueur n'est disponible pour le moment. V√©rifiez que le backend est d√©marr√© ou r√©essayez plus tard.</p>
    <button class="cta-button" (click)="loadData()" aria-label="Recharger le classement">
      <span>Recharger</span>
      <span aria-hidden="true">‚Üª</span>
    </button>
  </div>
  <!-- Main Content -->
  <main id="main-content" *ngIf="!loading && !error && filteredPlayers.length > 0" class="main-content">
    
    <!-- Search and Filters -->
    <section class="controls" aria-labelledby="filters-heading">
      <h2 id="filters-heading" class="sr-only">Filtres et recherche</h2>
      <label for="search-input" class="sr-only">Rechercher un joueur par nom</label>
      <input 
        id="search-input"
        type="text" 
        [(ngModel)]="searchTerm" 
        (input)="filterPlayers()"
        placeholder="Rechercher un joueur..."
        class="search-input"
        aria-label="Rechercher un joueur par nom ou pseudo"
        role="searchbox">
        
      <label for="region-select" class="sr-only">Filtrer par r√©gion</label>
      <select id="region-select" [(ngModel)]="selectedRegion" (change)="filterPlayers()" class="region-select" aria-label="Filtrer les joueurs par r√©gion">
        <option value="">Toutes les r√©gions</option>
        <option value="EU">Europe</option>
        <option value="NAW">NAW (Am√©rique du Nord Ouest)</option>
        <option value="ASIA">Asie</option>
        <option value="BR">Br√©sil</option>
        <option value="NAC">NAC (Am√©rique du Nord Centre)</option>
        <option value="OCE">Oc√©anie</option>
        <option value="ME">Moyen-Orient</option>
      </select>
      
      <button (click)="resetFilters()" class="reset-btn" aria-label="R√©initialiser tous les filtres">R√©initialiser les filtres</button>
    </section>
    
    <!-- Stats -->
    <section class="stats" aria-labelledby="stats-heading">
      <h2 id="stats-heading" class="sr-only">Statistiques g√©n√©rales</h2>
      <div class="stat-item" role="group" aria-labelledby="players-count">
        <span class="stat-number" id="players-count-value">{{ filteredPlayers.length }}</span>
        <span class="stat-label" id="players-count">Joueurs</span>
      </div>
      <div class="stat-item" role="group" aria-labelledby="total-points">
        <span class="stat-number" id="total-points-value">{{ getTotalPoints() | number }}</span>
        <span class="stat-label" id="total-points">Points Total</span>
      </div>
    </section>
    
    <!-- Podium Top 3 -->
    <section *ngIf="filteredPlayers.length >= 3" class="podium" aria-labelledby="podium-heading">
      <h2 id="podium-heading" class="sr-only">Podium des 3 meilleurs joueurs</h2>
      
      <div class="podium-item second" role="group" aria-labelledby="second-place" tabindex="0">
        <div class="rank" role="img" aria-label="Deuxi√®me place">2√®me</div>
        <div class="avatar" role="img" [attr.aria-label]="'Avatar de ' + filteredPlayers[1].nickname">{{ getInitials(filteredPlayers[1].nickname) }}</div>
        <div class="name" id="second-place">{{ filteredPlayers[1].nickname }}</div>
        <div class="points" [attr.aria-label]="(filteredPlayers[1].totalPoints | number) + ' points'">{{ filteredPlayers[1].totalPoints | number }}</div>
      </div>
      
      <div class="podium-item first" role="group" aria-labelledby="first-place" tabindex="0">
        <div class="rank" role="img" aria-label="Premi√®re place">1er</div>
        <div class="avatar" role="img" [attr.aria-label]="'Avatar de ' + filteredPlayers[0].nickname">{{ getInitials(filteredPlayers[0].nickname) }}</div>
        <div class="name" id="first-place">{{ filteredPlayers[0].nickname }}</div>
        <div class="points" [attr.aria-label]="(filteredPlayers[0].totalPoints | number) + ' points'">{{ filteredPlayers[0].totalPoints | number }}</div>
      </div>
      
      <div class="podium-item third" role="group" aria-labelledby="third-place" tabindex="0">
        <div class="rank" role="img" aria-label="Troisi√®me place">3√®me</div>
        <div class="avatar" role="img" [attr.aria-label]="'Avatar de ' + filteredPlayers[2].nickname">{{ getInitials(filteredPlayers[2].nickname) }}</div>
        <div class="name" id="third-place">{{ filteredPlayers[2].nickname }}</div>
        <div class="points" [attr.aria-label]="(filteredPlayers[2].totalPoints | number) + ' points'">{{ filteredPlayers[2].totalPoints | number }}</div>
      </div>
    </section>
    
    <!-- Players Table -->
    <div class="table-container">
      <table class="players-table" role="table" aria-labelledby="table-caption">
        <caption id="table-caption" class="sr-only">
          Player leaderboard showing rank, name, region, and points. 
          {{ filteredPlayers.length }} players displayed, sorted by points descending.
        </caption>
        <thead>
          <tr role="row">
            <th scope="col" aria-sort="none" role="columnheader">
              <button class="sort-header" (click)="sortBy('rank')" 
                      aria-label="Sort by rank"
                      [attr.aria-pressed]="currentSort === 'rank'">Rang</button>
            </th>
            <th scope="col" role="columnheader">Joueur</th>
            <th scope="col" role="columnheader">
              <button class="sort-header" (click)="sortBy('region')" 
                      aria-label="Sort by region"
                      [attr.aria-pressed]="currentSort === 'region'">R√©gion</button>
            </th>
            <th scope="col" aria-sort="descending" role="columnheader">
              <button class="sort-header" (click)="sortBy('points')" 
                      aria-label="Sort by points, currently sorted descending"
                      [attr.aria-pressed]="currentSort === 'points'">
                Points
              </button>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let player of getPaginatedPlayers(); let i = index; trackBy: trackByPlayer" 
              class="player-row" 
              role="row"
              [attr.aria-rowindex]="i + 2"
              [attr.aria-label]="'Player rank ' + player.rank + ': ' + player.nickname + ' from ' + player.region + ' with ' + (player.totalPoints | number) + ' points'">
            <td class="rank-cell" role="gridcell">
              <span class="rank-badge" [attr.aria-label]="'Rank ' + player.rank">{{ player.rank }}</span>
            </td>
            
            <td class="player-cell" role="gridcell">
              <div class="player-info">
                <div class="player-avatar" 
                     role="img" 
                     [attr.aria-label]="'Avatar for ' + player.nickname">{{ getInitials(player.nickname) }}</div>
                <div class="player-details">
                  <div class="player-nickname">{{ player.nickname }}</div>
                  <div class="player-username">{{ getAtSymbol() }}{{ player.username }}</div>
                </div>
              </div>
            </td>
            
            <td class="region-cell" role="gridcell">
              <span class="region-badge" [attr.aria-label]="'Region: ' + player.region">{{ player.region }}</span>
            </td>
            
            <td class="points-cell" role="gridcell">
              <span class="points-value" [attr.aria-label]="(player.totalPoints | number) + ' points'">{{ player.totalPoints | number }}</span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    
    <!-- Pagination -->
    <nav *ngIf="getTotalPages() > 1" class="pagination" role="navigation" aria-label="Leaderboard pagination">
      <button 
        [disabled]="currentPage === 1" 
        (click)="goToPage(currentPage - 1)"
        class="page-btn"
        [attr.aria-label]="'Go to previous page, currently on page ' + currentPage">
        ‚¨ÖÔ∏è Pr√©c√©dent
      </button>
      
      <span class="page-info" aria-live="polite" aria-atomic="true">
        Page {{ currentPage }} sur {{ getTotalPages() }}
      </span>
      
      <button 
        [disabled]="currentPage === getTotalPages()" 
        (click)="goToPage(currentPage + 1)"
        class="page-btn"
        [attr.aria-label]="'Go to next page, currently on page ' + currentPage">
        Suivant ‚û°Ô∏è
      </button>
    </nav>
    
    <!-- Empty State -->
    <div *ngIf="filteredPlayers.length === 0" class="empty-state">
      <h3>üòî Aucun joueur trouv√©</h3>
      <p>Essayez de modifier vos crit√®res de recherche</p>
      <button (click)="resetFilters()" class="reset-btn">R√©initialiser les filtres</button>
    </div>
    
  </main>
</div>

