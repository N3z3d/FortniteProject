<div class="trade-hub-container">
    <!-- Hero Section -->
    <header class="market-hero">
        <div class="hero-content">
            <div class="market-status">
                <span class="status-indicator live"></span>
                <span class="status-text">MARCHÉ OUVERT</span>
            </div>
            <h1 class="hero-title">
                <mat-icon class="hero-icon">swap_horiz</mat-icon>
                Trade Hub
            </h1>
            <p class="hero-subtitle">
                La place de marché officielle pour les transferts de joueurs.
            </p>

            <div class="market-stats" *ngIf="!isLoading">
                <div class="stat-item">
                    <span class="stat-val">{{ trades.length }}</span>
                    <span class="stat-lbl">Offres</span>
                </div>
                <div class="stat-divider"></div>
                <div class="stat-item">
                    <span class="stat-val">{{ getActiveTradesCount() }}</span>
                    <span class="stat-lbl">Actifs</span>
                </div>
            </div>
        </div>

        <div class="hero-actions">
            <button mat-flat-button color="primary" (click)="createNewTrade()" class="create-btn">
                <mat-icon>add_circle</mat-icon>
                Créer une offre
            </button>
        </div>

        <div class="hero-bg-effect"></div>
    </header>

    <!-- Controls Bar -->
    <div class="controls-bar">
        <div class="search-input">
            <mat-icon>search</mat-icon>
            <input type="text" placeholder="Rechercher un joueur, une équipe..." [(ngModel)]="searchTerm"
                (ngModelChange)="applyFilters()">
        </div>

        <div class="filter-tabs">
            <button class="tab-btn" [class.active]="activeTab === 'ALL'" (click)="setTab('ALL')">
                Tout
            </button>
            <button class="tab-btn" [class.active]="activeTab === 'PENDING'" (click)="setTab('PENDING')">
                En cours
                <span class="badge" *ngIf="getPendingCount() > 0">{{ getPendingCount() }}</span>
            </button>
            <button class="tab-btn" [class.active]="activeTab === 'HISTORY'" (click)="setTab('HISTORY')">
                Historique
            </button>
        </div>
    </div>

    <!-- Loading State -->
    <div class="loading-state" *ngIf="isLoading">
        <mat-spinner diameter="50"></mat-spinner>
        <p>Chargement du marché...</p>
    </div>

    <!-- Empty State -->
    <div class="empty-state" *ngIf="!isLoading && filteredTrades.length === 0">
        <mat-icon>shopping_bag</mat-icon>
        <h3>Aucune offre trouvée</h3>
        <p *ngIf="searchTerm">Aucun résultat pour "{{ searchTerm }}"</p>
        <p *ngIf="!searchTerm">Le marché est calme pour le moment.</p>
        <button mat-stroked-button color="primary" (click)="createNewTrade()" *ngIf="!searchTerm">
            Lancer une offre
        </button>
    </div>

    <!-- Trades Grid -->
    <div class="trades-grid" *ngIf="!isLoading && filteredTrades.length > 0">
        <div class="trade-card" *ngFor="let trade of filteredTrades; trackBy: trackByTradeId"
            [class.completed]="trade.status === 'COMPLETED'" [class.cancelled]="trade.status === 'CANCELLED'">

            <div class="card-header">
                <div class="team-info">
                    <mat-icon class="team-icon">group</mat-icon>
                    <span class="team-name">{{ trade.team.name }}</span>
                </div>
                <span class="trade-date">{{ trade.createdAt | date:'dd MMM' }}</span>
            </div>

            <div class="trade-body">
                <div class="trade-side out">
                    <span class="side-label">Cède</span>
                    <div class="player-info">
                        <span class="player-name">{{ trade.playerOut.username }}</span>
                        <span class="player-region">{{ trade.playerOut.region || '??' }}</span>
                    </div>
                </div>

                <div class="trade-visual">
                    <div class="exchange-icon">
                        <mat-icon>sync_alt</mat-icon>
                    </div>
                </div>

                <div class="trade-side in">
                    <span class="side-label">Reçoit</span>
                    <div class="player-info">
                        <span class="player-name">{{ trade.playerIn.username }}</span>
                        <span class="player-region">{{ trade.playerIn.region || '??' }}</span>
                    </div>
                </div>
            </div>

            <div class="card-footer">
                <div class="status-badge" [ngClass]="trade.status.toLowerCase()">
                    <span class="dot"></span>
                    {{ getStatusLabel(trade.status) }}
                </div>

                <div class="actions">
                    <button mat-icon-button (click)="viewTrade(trade.id)" matTooltip="Voir détails">
                        <mat-icon>visibility</mat-icon>
                    </button>
                    <button mat-icon-button class="cancel-btn" (click)="cancelTrade(trade.id)"
                        *ngIf="trade.status === 'PENDING'" matTooltip="Annuler l'offre">
                        <mat-icon>close</mat-icon>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>